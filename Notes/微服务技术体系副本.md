# 微服务导图

## 什么是微服务

### 拆分粒度更细

### 独立性

#### 独立开发

#### 独立部署

#### 独立进程

### 服务治理要求高

### 轻量级通讯

### 基于业务能力

## 初探微服务架构

### 架构图

### 基本组件

#### 服务描述

##### 包含内容

###### 服务名称

###### 服务参数

###### 返回格式

##### 描述方式

###### XML

###### RESTful API

###### IDL

#### 注册中心

##### 工作流程

###### 

#### 服务框架

##### 通讯协议

###### 七层HTTP/四层TCP，UDP

##### 传输方式

###### 同步/异步

###### 单路/多路

##### 数据压缩格式

###### JSON序列号

###### Java对象序列号

###### Protobuf序列号

#### 服务监控

##### 指标收集

###### 性能，耗时，成功与否

##### 数据处理

###### 平均耗时，请求量

##### 数据展示

#### 服务追踪

##### 链路跟踪

###### 问题追踪

###### 故障定位

#### 服务治理

通过一系列的手段来保证在各种意外情况下，服务调用仍然能够正常运行


##### 分类

###### 单机故障

###### 单IDC故障

###### 服务不可用

##### 作用


监控是发现问题，只有追踪才能定位问题，解决问题靠治理

## 服务发布和引用

### 常见三种

#### RESTful API

#### XML配置

#### IDL文件

##### 跨语言调用

###### Thrift协议

###### gRPC协议

## 服务注册和发现

### 注册中心原理

### 注册中心实现方式

#### 注册中心API

##### 服务注册

##### 服务删除

##### 心跳汇报

##### 服务查询

##### 服务订阅

#### 集群部署

##### ZooKeeper

#### 目录存储

#### 服务监控状态监测

#### 服务状态变更

#### 白名单机制

## 服务监控

### 监控对象

#### 用户监控

#### 接口监控

#### 资源监控

##### redis

#### 基础监控

##### cpu,内存

### 监控指标

#### 请求量

##### 实时请求量

###### 每秒查询次数QPS

##### 实时请求量

###### 一段时间的查询次数PV

#### 响应时间

##### 一段时间平均响应时间

##### 更关心慢时间500ms以上

#### 错误率

##### 一段时间调用错误次数占比总的调用次数

### 监控维度

#### 整体维度

##### 请求量，平均耗时，错误率

#### 多机房

#### 单机房

#### 时间维度

##### 每天，周，月的指标

#### 核心维度

### 监控原理

#### 采集

##### 内容

###### 响应时间

###### 成功与否

###### 发起者/接受者

##### 方式

###### 主动上报

###### 代理收集

##### 采集频率

#### 传输

##### 协议

###### UPD

###### Kafka

##### 格式

###### 二进制

####### PB对象/高压缩高性能

###### 文本

####### JSON可读性好

#### 处理

##### 内容

###### 聚合计算出请求量/响应时间/错误率

##### 维度

###### 接口聚合

###### 机器聚合

##### 存储

###### 索引数据库Elasticsearch

###### 时序数据库OpenTSDB

#### 展示

##### 曲线图

######  

##### 饼状图

###### 

##### 格子图

###### 

## 服务治理

### 服务管理

#### 服务上下线

#### 节点增删改查

### 服务治理

#### 限流

#### 降级

#### 切流量

### 服务监控

#### 整体监控拓扑图

#### 具体服务监控

### 问题定位

#### 宏观层面

#### 微观层面

### 日志查询

#### ELK

### 服务运维

#### 发布部署

#### 扩缩容

![微服务技术体系副本](%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB%E5%89%AF%E6%9C%AC.assets/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB%E5%89%AF%E6%9C%AC-1626936054749.png)

